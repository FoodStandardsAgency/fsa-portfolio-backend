DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'FSAPortfolio.Entites.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202009281307554_InitialCreate'
BEGIN
    CREATE TABLE [dbo].[AccessGroups] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](50),
        CONSTRAINT [PK_dbo.AccessGroups] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Users] (
        [Id] [int] NOT NULL IDENTITY,
        [Timestamp] [datetime] NOT NULL,
        [UserName] [nvarchar](50),
        [PasswordHash] [nvarchar](300),
        [AccessGroupId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_AccessGroupId] ON [dbo].[Users]([AccessGroupId])
    ALTER TABLE [dbo].[Users] ADD CONSTRAINT [FK_dbo.Users_dbo.AccessGroups_AccessGroupId] FOREIGN KEY ([AccessGroupId]) REFERENCES [dbo].[AccessGroups] ([Id])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202009281307554_InitialCreate', N'FSAPortfolio.Entites.Migrations.Configuration',  0x1F8B0800000000000400ED59DB6EE336107D2FD07F10F458642D274181D6B077917AE3ADD1CD055176D1B78096C636518A54492A6BA3E897F5A19FD45FE8507789B2AD7893455B14018C989A39731FCEC87FFDF1E7F8CD2662CE234845059FB8A783A1EB000F4448F96AE2267AF9EA3BF7CDEBAFBF1A5F86D1C6F958D09D1B3AE4E46AE2AEB58E479EA7823544440D221A48A1C4520F0211792414DED970F8BD777AEA0142B888E538E3BB846B1A41FA05BF4E050F20D60961572204A6F2737CE2A7A8CE358940C52480893BF32F6E85D44BC1A8185C228C06E53A178C12D4C507B6741DC2B9D044A3A6A30F0A7C2D055FF9311E1076BF8D01E9968429C82D1855E47D8D199E1963BC8AB1800A12A545F444C0D3F3DC3B5E9BFD281FBBA5F7D07FA983B6C6EAD48713F7220840A9775224B1EBB4E58DA64C1ADA6E2F0FD099520D6A08274E17DD499927984EE6EFC499264C2712261C122D093B716E9305A3C14FB0BD17BF009FF084B1BADEA8393E6B1CE0D1AD143148BDBD83656ECD3C741DAFC9E7B5194BB61A4F66E49CEBF333D7B946E164C1A04C8B9A437C2D24BC030E9268086F89D620B9C180D4B196F4962CF35948C33CC4A2729D2BB2790F7CA5D713F75BACA219DD40581CE40A7CE0144B1079B44CA02963EC5521DD1B6813AC23236C3EFF0FED81D0DE63FF529A447121F22DC298C30EA9FB918CBB9F3F516C39B744A94F42863F12B5DE23EB7CF81CC26A5DE270545A50D7E491AED220ED06759D3B60298D5AD338EBFC69E23E34886652447782E55EAE3F7BF0452203E374B183E09EC815E87EE577A1940868AA4F2DAA0D5D9A365EF2D039A45816A1C2300C12961A8DB1B8508189FB8DE5B73D98852D35CC869F9AD0A71634D62548531884E165ADB0D229D77611531ED098B0035AB4F87A96BF717E29A1FDE42DC4C04DE51E706A1FD1ADD4B5B52885B5DAD321278DBD5A9AD8CD1B793472802CEAB5E8BEE6016C7447374733F386AEF2B26C678401F641DBA6E1D054A572574A58C9D5844AAF8A0E8C2C555BCC35BB9B08CD6AAD91EDAAE876307AD451A979A9B415D21E955343697AB17D49356DEDE81D659CAB31D7CBE6DC621EF6760CC4E32B12C7D8AF6B03727EE2F8D9743C7DE53F7D688C320C2F501DB363A96D2909EF4DB282D653148D9ACEA8541A2F42B220A6AF4FC3C822B3B27A479A15E23A12D78E5E91830593F93F63EC1C73F62454E5D2195A19998E920E0ADDE1B7B9D39D8530223B4693A96049C477F7B7DDDCD97850E7CF4E6C84B1D752DFEA5E96B75AF9DB8E40AFF86485F5D981499BC7D323D2CDF632A1A8CD7D7590DA717FAC6AF2AB4355A7FD919AB35D1DADF9A43F62EB16AC431EB8205F3809AD36DA2629A597EDB4D536C7790B3BFCB2C1EA691989EBA0B31E6968FA99BF551AA2812118F8BFB229A3686F457045385D626664CB908BDBFE59EB6DC53FE7CD81A754C83EE7F5C11CA7A2CDC4FDCDF9FDCB6F7CD478FDE04EF7C4D5ACBE96F14722833591D66256613EFFBAFE9FF3A8B5368788AB9F636D3E2A3EFDB6E44EE8744F7E1A76E7529CBA7977E00DE7C899FFFCD0603E716E2476979133C4CCD8EFB91758591B5DE0D895B239731FB1EE1EB593EE1FFD5E640FFD572D9DF614DF7BA33CB45066772756FC4260B4B37CDDBB4A75AD9C3B37CE2EF4CE75EF8B2CA31D6EB17687436BA8B5B9BECCAE690F439854B5DF6730A7155D5510E6D71A0E41239D4A9A395F8A22B95B1A1524AD9E78059AE01D402EA4A64B12687C6C5C94BE95FC4858822497D102C239BF49749C683419A2056BBC9F35D5B14F7EBA5037751EDFC4E9CBC3E73001D5A4E61ABBE13F249485A5DEB38E66BC03C2945D7ECB9A586A73DBAEB625D2B5E03D8172F795DDE21EA2982198BAE13E79846374C3D47B0F2B126C8B997637C8E14034DD3E7E4BC94A9248E51815BFF9CDD1333F3ABEFE1B2BC92D52A61C0000 , N'6.4.4')
END

